# gc pool

[../mark_and_sweep](mark_and_sweep)では、メモリが足りなくなるとGCを行う必要があり、
そのために、使用しているデータは全て記録しなくてはなりませんでした。

これは面倒です。auto release poolは参照カウンタの上下をイチイチするのが面倒なので貯める事が出来る仕組みでした。

オートリリースプールのようなオブジェクトプールを作ってそこに溜め込んでおくようにすれば、完全なGC使ったプログラムをもっと楽にかけるはずです。

ここでは、アロケーションするとフレームのプールに保存し、フレームを抜けるとプールへの参照を無くす仕組みを作ることで、
変数をわざわざルート集合に加えなくても使える仕組みを作ります。

この仕組みを使えば、C言語のプログラムで楽に完全なGCをサポートできます。
問題は、GCが発生した際に、本来なら未使用のデータが使用中として扱われる事です。このことはマルチワールドGCと組み合わせる事で解消出来るのではないかと
思います。小さい計算領域中では、多めにメモリを確保して一気に計算し、終わったらコピーGCをして終わる。
というようなモデルで大概は十分な性能が出せるはずです。
メモリを異常に食うようなデータはオートリリースプールに入れなければ良いのです。


